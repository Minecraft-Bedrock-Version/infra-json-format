{
  "src": "iam_role node_id",
  "dst": "secretsmanager_secret node_id",
  "directed": true,
  "conditions": [
    {
      "iam_role": {
        "attributes": {
          "assume_role_policy": {
            "Statement": [
              {
                "Action": ["sts:AssumeRole"],
                "Effect": "Allow"
              }
            ],
            "attached_policies": [
              {
                "Statement": [
                  {
                    "Effect": "Allow",
                    "Action": ["secretsmanager:ListSecrets"]
                  },
                  {
                    "Effect": "Allow",
                    "Action": ["secretsmanager:GetSecretValue"]
                  }
                ]
              }
            ]
          }
        }
      }
    }
  ]
}
